"2009-05-15

se focuscontent 
se titlestring="Firefox â€” Vimperator"
"se fullscreen on
se! browser.tabs.closeButtons=2
"se editor = "C:\Program Files\Vim\vim72\gvim.exe -f"

set toolbars=noaddons,nobookmarks,nomenu,nonavigation,tabs

hi StatusLine 		background: #acacac; color:#303030;  font-family:arial; font-weight:normal;padding:1px 5px 1px 1px;border:none;outline:none;	
hi Hint             padding:1px 2px;font-size:12px;line-height:1;background:#c00;color:#fff;

map <C-a> <C-v><C-a>
imap <C-a> <esc><C-v><C-a>

map s :stop<cr>

map <C-r> :restart<cr>

map <F8> :se go+=mT<cr>
map <S-F8> :se go-=mT<cr>

noremap H gT
noremap L gt

map > :fo<cr>
map < :ba<cr>
"map ,ie :open chrome://ietab/content/reloaded.html?url=encodeURIComponent(liberator.modules.buffer.URL)<cr>

autocmd LocationChange .* :js modes.passAllKeys = /newsblur\.com|mail\.google\.com|www\.artlebedev\.ru|www.\.google\.ru\/reader|www\.google\.com\/reader\/view|docker\.com\/tryit/.test(buffer.URL)



javascript <<EOF

(function(){

    var btns = ["feed-button", "ffvkontaktemusic-button"];

    function gid(id){return document.getElementById(id) || null}

    function AddToStatusline(id, i){
        if(!gid(id)) return;
        var button = document.createElement("statusbarpanel");
        var clone = gid(id)
        button.appendChild(clone);
        button.setAttribute("style", "padding:0;margin:0;max-height:16px;line-height:16px;max-width:24px;overflow:hidden;");
        clone.setAttribute("style", "padding:0;margin:0;max-height:16px;line-height:16px;max-width:24px;overflow:hidden;");
        gid("status-bar").insertBefore(button, gid("liberator-statusline").nextSibling);
    }

    btns.forEach(function(el,i){AddToStatusline(el,i);})


// adds feed for Google reader command 
commands.addUserCommand(
    ['feedgooglereader', 'fgr'],
    'feed current site URL to Google Reader',
    function () {
        let doc = content.document;
        let b = doc.body;
        let GR________bookmarklet_domain = 'http://www.google.com';
        if (b && ! doc.xmlVersion){
            let z = doc.createElement('script');
            z.src = 'http://www.google.com/reader/ui/subscribe-bookmarklet.js';
            z.type = 'text/javascript';
            b.appendChild(z);
        }
        else {
            liberator.open(
                'http://www.google.com/reader/view/feed/' + encodeURIComponent(liberator.modules.buffer.URL),
                (options['newtab'] && options.get('newtab').has('all'))
                    ? liberator.NEW_TAB
                    : liberator.CURRENT_TAB
            );
        }
    },
    {}
);


// set favicon in statusline
    var setFavicon = function(){
        var p = document.getElementById('page-proxy-favicon-clone');
        var b = document.getElementById('page-proxy-favicon');
        if (!p) {
            p = document.createElement('statusbarpanel');
            p.setAttribute('id','page-proxy-favicon-clone');
            p.appendChild(b.cloneNode(true));
            document.getElementById('status-bar').insertBefore(p,document.getElementById('liberator-statusline'));
        }
        if (p.childNodes.length > 0) {
            var node = p.childNodes.item(0);
            node.setAttribute('src', b.getAttribute('src'));
        }
    }
    getBrowser().addEventListener("load", function() setFavicon() , true);
    getBrowser().addEventListener("TabSelect", function() setFavicon() , true);
})();

EOF
